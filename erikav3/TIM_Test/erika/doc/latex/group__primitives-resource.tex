\doxysection{Resource Primitives }
\hypertarget{group__primitives-resource}{}\label{group__primitives-resource}\index{Resource Primitives@{Resource Primitives}}


The Resource Primitives are related to shared resource handling in single cores.  


\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{group__primitives-resource_ga92783ef01a97745e1f4a6696cb889d86}{INVALID\+\_\+\+RESOURCE}}~((\mbox{\hyperlink{group__primitives-resource_gaac3971a971a95d78051b389553842386}{Resource\+Type}})-\/1)
\begin{DoxyCompactList}\small\item\em Invalid resource ID. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{group__primitives-resource_ga286e6fb0ad7ab110ca50a94305981769}{Declare\+Resource}}(Res)
\begin{DoxyCompactList}\small\item\em Resource Declaration. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef \mbox{\hyperlink{ee__api__types_8h_a7b62a74d3f3436ea0f46d9f0906a5844}{OSEE\+\_\+\+RESOURCE\+\_\+\+ID\+\_\+\+TYPE}} \mbox{\hyperlink{group__primitives-resource_gaac3971a971a95d78051b389553842386}{Resource\+Type}}
\begin{DoxyCompactList}\small\item\em Type for Resource IDs. \end{DoxyCompactList}\item 
typedef \mbox{\hyperlink{ee__api__types_8h_a7bfbe7391e1694cc2f73243016b92fbf}{OSEE\+\_\+\+SCHEDULETABLE\+\_\+\+TYPE}} \mbox{\hyperlink{group__primitives-resource_gaece92730f23a01b1dc858668f7d3b18b}{Schedule\+Table\+Type}}
\begin{DoxyCompactList}\small\item\em Type for Schedule Tables. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{ee__api__types_8h_a79bf54a17078edb124b553c51129396a}{Status\+Type}} \mbox{\hyperlink{ee__compiler__cfg_8h_a919da7d9b61966c3af796ab42e618bef}{OS\+\_\+\+CODE}} \mbox{\hyperlink{group__primitives-resource_ga029c759ca879fd237a4a3cc7234c9203}{Get\+Resource}} (\mbox{\hyperlink{group__primitives-resource_gaac3971a971a95d78051b389553842386}{Resource\+Type}} Res\+ID)
\begin{DoxyCompactList}\small\item\em Locks a shared resource. \end{DoxyCompactList}\item 
\mbox{\hyperlink{ee__api__types_8h_a79bf54a17078edb124b553c51129396a}{Status\+Type}} \mbox{\hyperlink{ee__compiler__cfg_8h_a919da7d9b61966c3af796ab42e618bef}{OS\+\_\+\+CODE}} \mbox{\hyperlink{group__primitives-resource_ga17c54e2aa306b4d6a3f233c5cbc411c5}{Release\+Resource}} (\mbox{\hyperlink{group__primitives-resource_gaac3971a971a95d78051b389553842386}{Resource\+Type}} Res\+ID)
\begin{DoxyCompactList}\small\item\em Releases a resource previously locked with Get\+Resource. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Resources are the term used by ERIKA3 to refer to binary semaphores used to implement shared critical sections.

Resources are implemented using the Immediate Priority Ceiling protocol.

A resource is locked using the primitive \doxylink{group__primitives-resource_ga029c759ca879fd237a4a3cc7234c9203}{Get\+Resource()}, and unlocked using \doxylink{group__primitives-resource_ga17c54e2aa306b4d6a3f233c5cbc411c5}{Release\+Resource()}.

A special resource named RES\+\_\+\+SCHEDULER is also supported. The RES\+\_\+\+SCHEDULER resource has a ceiling equal to the highest priority in the system. As a result, a task locking RES\+\_\+\+SCHEDULER becomes non-\/preemptive. If needed, the RES\+\_\+\+SCHEDULER resource have to be configured in the OIL configuration file.

On multiprocessor systems, Resources are divided in\+:
\begin{DoxyItemize}
\item {\itshape Local resources} A Resource is local when all the tasks that uses it are assigned to the same processor. In this case you should use a Resource to implement the mutual exclusion.
\item {\itshape Global resources} A Resource is global when the tasks that uses it are assigned to different processors. In this case you should use a Spin Lock to implement the mutual exclusion.
\end{DoxyItemize}

A special kind of resources, called {\itshape Internal Resources}, are also supported by ERIKA3. Internal Resources are locked when the tasks enter the RUNNING state, and it is released when the task ends. Internal resources are used by optimization algorithms to limit the maximum stack space used by application tasks. Please note that \doxylink{group__primitives-task_ga51ead35687ec6feef92e3724fe359215}{Schedule()} explicitly release any Internal Resource locked by the running task, thus limiting the possibility to reduce the overall stack in the system. Also \doxylink{group__primitives-event_ga01ccee0d30cdc7288a518351244b16b7}{Wait\+Event()} always release the internal resource of the task; however, this fact does not impact on stack usage because tasks using \doxylink{group__primitives-event_ga01ccee0d30cdc7288a518351244b16b7}{Wait\+Event()} must run on a private stack since \doxylink{group__primitives-event_ga01ccee0d30cdc7288a518351244b16b7}{Wait\+Event()} is a blocking primitive. Please also note that on Multicore systems, Internal Resources can only be {\itshape local}. Global Internal Resources are not supported.

ERIKA3 supports resource management at ISR level for a selected number of architectures. Please check on the ERIKA3 wiki whether the architecture you are currently using supports this feature. The implementation of this feature is implemented extending the OIL configuration to accept ISR priority as extra field in ISR Object definition. The ISR Priority field contains architecture independent values which are then mapped by RT-\/\+Druid to Task and Interrupt Controller priority values. 

\label{doc-define-members}
\Hypertarget{group__primitives-resource_doc-define-members}
\doxysubsection{Macro Definition Documentation}
\Hypertarget{group__primitives-resource_ga286e6fb0ad7ab110ca50a94305981769}\index{Resource Primitives@{Resource Primitives}!DeclareResource@{DeclareResource}}
\index{DeclareResource@{DeclareResource}!Resource Primitives@{Resource Primitives}}
\doxysubsubsection{\texorpdfstring{DeclareResource}{DeclareResource}}
{\footnotesize\ttfamily \label{group__primitives-resource_ga286e6fb0ad7ab110ca50a94305981769} 
\#define Declare\+Resource(\begin{DoxyParamCaption}\item[{}]{Res}{}\end{DoxyParamCaption})}

Declares a resource used by Tasks.

This declaration is currently not mandatory because resource identifiers are all declared within the code generated by RT-\/\+Druid.

Reference\+: OSEK OS -\/ ISO 17356-\/3 -\/ 13.\+5.\+2.\+1


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{in}}  & {\em Res} & The resource to be declared. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\Hypertarget{group__primitives-resource_ga92783ef01a97745e1f4a6696cb889d86}\index{Resource Primitives@{Resource Primitives}!INVALID\_RESOURCE@{INVALID\_RESOURCE}}
\index{INVALID\_RESOURCE@{INVALID\_RESOURCE}!Resource Primitives@{Resource Primitives}}
\doxysubsubsection{\texorpdfstring{INVALID\_RESOURCE}{INVALID\_RESOURCE}}
{\footnotesize\ttfamily \label{group__primitives-resource_ga92783ef01a97745e1f4a6696cb889d86} 
\#define INVALID\+\_\+\+RESOURCE~((\mbox{\hyperlink{group__primitives-resource_gaac3971a971a95d78051b389553842386}{Resource\+Type}})-\/1)}

A constant representing an invalid Resource. 

\label{doc-typedef-members}
\Hypertarget{group__primitives-resource_doc-typedef-members}
\doxysubsection{Typedef Documentation}
\Hypertarget{group__primitives-resource_gaac3971a971a95d78051b389553842386}\index{Resource Primitives@{Resource Primitives}!ResourceType@{ResourceType}}
\index{ResourceType@{ResourceType}!Resource Primitives@{Resource Primitives}}
\doxysubsubsection{\texorpdfstring{ResourceType}{ResourceType}}
{\footnotesize\ttfamily \label{group__primitives-resource_gaac3971a971a95d78051b389553842386} 
typedef \mbox{\hyperlink{ee__api__types_8h_a7b62a74d3f3436ea0f46d9f0906a5844}{OSEE\+\_\+\+RESOURCE\+\_\+\+ID\+\_\+\+TYPE}} \mbox{\hyperlink{group__primitives-resource_gaac3971a971a95d78051b389553842386}{Resource\+Type}}}

Type used to store a Resource ID. \Hypertarget{group__primitives-resource_gaece92730f23a01b1dc858668f7d3b18b}\index{Resource Primitives@{Resource Primitives}!ScheduleTableType@{ScheduleTableType}}
\index{ScheduleTableType@{ScheduleTableType}!Resource Primitives@{Resource Primitives}}
\doxysubsubsection{\texorpdfstring{ScheduleTableType}{ScheduleTableType}}
{\footnotesize\ttfamily \label{group__primitives-resource_gaece92730f23a01b1dc858668f7d3b18b} 
typedef \mbox{\hyperlink{ee__api__types_8h_a7bfbe7391e1694cc2f73243016b92fbf}{OSEE\+\_\+\+SCHEDULETABLE\+\_\+\+TYPE}} \mbox{\hyperlink{group__primitives-resource_gaece92730f23a01b1dc858668f7d3b18b}{Schedule\+Table\+Type}}}

Type used to store a Schedule Table. 

\label{doc-func-members}
\Hypertarget{group__primitives-resource_doc-func-members}
\doxysubsection{Function Documentation}
\Hypertarget{group__primitives-resource_ga029c759ca879fd237a4a3cc7234c9203}\index{Resource Primitives@{Resource Primitives}!GetResource@{GetResource}}
\index{GetResource@{GetResource}!Resource Primitives@{Resource Primitives}}
\doxysubsubsection{\texorpdfstring{GetResource()}{GetResource()}}
{\footnotesize\ttfamily \label{group__primitives-resource_ga029c759ca879fd237a4a3cc7234c9203} 
\mbox{\hyperlink{ee__api__types_8h_a79bf54a17078edb124b553c51129396a}{Status\+Type}} \mbox{\hyperlink{ee__compiler__cfg_8h_a919da7d9b61966c3af796ab42e618bef}{OS\+\_\+\+CODE}} Get\+Resource (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{group__primitives-resource_gaac3971a971a95d78051b389553842386}{Resource\+Type}}}]{Res\+ID}{}\end{DoxyParamCaption})}

This primitive can be used to implement a critical section guarded by Resource Res\+ID. The critical section will end with the call to \doxylink{group__primitives-resource_ga17c54e2aa306b4d6a3f233c5cbc411c5}{Release\+Resource()}.

Nesting between critical sections guarded by different resources is allowed.

Calls to \doxylink{group__primitives-task_gaa59687009cf4d45c57eccd0366920e39}{Terminate\+Task()}, \doxylink{group__primitives-task_gaa219f309dc9471326804fda45f2fe449}{Chain\+Task()}, \doxylink{group__primitives-task_ga51ead35687ec6feef92e3724fe359215}{Schedule()}, and \doxylink{group__primitives-event_ga01ccee0d30cdc7288a518351244b16b7}{Wait\+Event()} are not allowed inside the critical section.

Resources may be called on ISR level as well (see ISO17356-\/3 8.\+7).

Conformance Classes\+: BCC1, BCC2, ECC1, ECC2

Reference\+: OSEK OS -\/ ISO 17356-\/3 -\/ 13.\+5.\+3.\+1


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{in}}  & {\em Res\+ID} & The resource to lock. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The function returns a \doxylink{ee__api__types_8h_a6def7470ef6da58026579b4be4ff5d68}{Status\+Type}.
\begin{DoxyItemize}
\item E\+\_\+\+OK No error.
\item E\+\_\+\+OS\+\_\+\+ID (Extended) Resource Res\+ID is invalid.
\item E\+\_\+\+OS\+\_\+\+ACCESS (Extended) Attempt to get a resource which is already occupied by any task or ISR, or the statically assigned priority of the calling task or interrupt routine is higher than the calculated ceiling priority. 
\end{DoxyItemize}
\end{DoxyReturn}


References \mbox{\hyperlink{ee__compiler_8h_a3851a1a8ddec9eacd2e30a8a19bb8cc8}{AUTOMATIC}}, \mbox{\hyperlink{ee__compiler_8h_aa8f07207960a32e918e08a0faf697977}{FUNC}}, \mbox{\hyperlink{group__primitives-resource_ga029c759ca879fd237a4a3cc7234c9203}{Get\+Resource()}}, \mbox{\hyperlink{ee__compiler__cfg_8h_a919da7d9b61966c3af796ab42e618bef}{OS\+\_\+\+CODE}}, and \mbox{\hyperlink{ee__compiler_8h_a44fc42ed93abd1afe9c2268543bc8faf}{VAR}}.



Referenced by \mbox{\hyperlink{group__primitives-resource_ga029c759ca879fd237a4a3cc7234c9203}{Get\+Resource()}}.

Here is the call graph for this function\+:
% FIG 0
Here is the caller graph for this function\+:
% FIG 1
\Hypertarget{group__primitives-resource_ga17c54e2aa306b4d6a3f233c5cbc411c5}\index{Resource Primitives@{Resource Primitives}!ReleaseResource@{ReleaseResource}}
\index{ReleaseResource@{ReleaseResource}!Resource Primitives@{Resource Primitives}}
\doxysubsubsection{\texorpdfstring{ReleaseResource()}{ReleaseResource()}}
{\footnotesize\ttfamily \label{group__primitives-resource_ga17c54e2aa306b4d6a3f233c5cbc411c5} 
\mbox{\hyperlink{ee__api__types_8h_a79bf54a17078edb124b553c51129396a}{Status\+Type}} \mbox{\hyperlink{ee__compiler__cfg_8h_a919da7d9b61966c3af796ab42e618bef}{OS\+\_\+\+CODE}} Release\+Resource (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{group__primitives-resource_gaac3971a971a95d78051b389553842386}{Resource\+Type}}}]{Res\+ID}{}\end{DoxyParamCaption})}

\doxylink{group__primitives-resource_ga17c54e2aa306b4d6a3f233c5cbc411c5}{Release\+Resource()} is used to release a resource locked using \doxylink{group__primitives-resource_ga029c759ca879fd237a4a3cc7234c9203}{Get\+Resource()}, closing a critical section.

For information on nested critical sections, see \doxylink{group__primitives-resource_ga029c759ca879fd237a4a3cc7234c9203}{Get\+Resource()}. The service may be called from an ISR and from task level.

Conformance Classes\+: BCC1, BCC2, ECC1, ECC2

Reference\+: OSEK OS -\/ ISO 17356-\/3 -\/ 13.\+5.\+3.\+2


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{in}}  & {\em Res\+ID} & The resource to lock. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The function returns a \doxylink{ee__api__types_8h_a6def7470ef6da58026579b4be4ff5d68}{Status\+Type}.
\begin{DoxyItemize}
\item E\+\_\+\+OK No error
\item E\+\_\+\+OS\+\_\+\+ID (Extended) Res\+ID is an invalid identifier
\item E\+\_\+\+OS\+\_\+\+NOFUNC (Extended) Attempt to release a resource which is not occupied by any task or ISR, or another resource shall be released before.
\item E\+\_\+\+OS\+\_\+\+ACCESS (Extended) Attempt to release a resource which has a lower ceiling priority than the statically assigned priority of the calling task or interrupt routine. 
\end{DoxyItemize}
\end{DoxyReturn}


References \mbox{\hyperlink{ee__compiler_8h_a3851a1a8ddec9eacd2e30a8a19bb8cc8}{AUTOMATIC}}, \mbox{\hyperlink{ee__compiler__cfg_8h_a919da7d9b61966c3af796ab42e618bef}{OS\+\_\+\+CODE}}, \mbox{\hyperlink{group__primitives-resource_ga17c54e2aa306b4d6a3f233c5cbc411c5}{Release\+Resource()}}, and \mbox{\hyperlink{ee__compiler_8h_a44fc42ed93abd1afe9c2268543bc8faf}{VAR}}.



Referenced by \mbox{\hyperlink{group__primitives-resource_ga17c54e2aa306b4d6a3f233c5cbc411c5}{Release\+Resource()}}.

Here is the call graph for this function\+:
% FIG 2
Here is the caller graph for this function\+:
% FIG 3
