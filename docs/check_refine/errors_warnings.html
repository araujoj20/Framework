<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<title>Errors &amp; Warnings â€“ Check &amp; Refine</title>
		<link rel="stylesheet" href="style.css" />
	</head>
	<body>
		<nav>
			<h1>Check &amp; Refine</h1>
			<div class="search-box">
				<input id="q" placeholder="Filter nav..." oninput="filterNav(this.value)" />
			</div>
			<a href="index.html">Overview</a>
			<a href="schema.html">JSON Schema</a>
			<a href="timers.html">Timers</a>
			<a href="dma.html">DMA</a>
			<a class="active" href="errors_warnings.html">Errors &amp; Warnings</a>
			<a href="examples.html">Examples</a>
		</nav>
		<main>
			<h1>Diagnostics Catalog</h1>
			<p>
				Refinement emits diagnostics to help users converge on valid configurations. <span class="tag err">Error</span>
				diagnostics remove the offending entity (field/timer/dma). <span class="tag warn">Warning</span> diagnostics
				adjust or drop only the problematic field while preserving the rest.
			</p>
			<h2>Error Categories</h2>
			<table>
				<thead>
					<tr>
						<th>Message Pattern</th>
						<th>Meaning</th>
						<th>Resolution</th>
					</tr>
				</thead>
				<tbody>
					<tr><td>Unknown timer</td><td>Timer name not in board capability list</td><td>Fix name or extend board JSON</td></tr>
					<tr><td>Request mismatch base timer</td><td><code>request</code> prefix differs from owning timer</td><td>Adjust request to match timer (e.g. TIM3_CH1)</td></tr>
					<tr><td>Channel out of range</td><td>Requested channel exceeds timer channel count</td><td>Lower channel index or change timer</td></tr>
					<tr><td>Invalid trigger_source</td><td>Not in board's allowed list</td><td>Pick listed source or update board config</td></tr>
					<tr><td>slave_mode requires trigger_source</td><td>Dependency missing</td><td>Add valid trigger_source or set slave_mode DISABLE</td></tr>
					<tr><td>Unsupported master_output_trigger</td><td>Timer lacks capability / value invalid</td><td>Remove or select allowed value</td></tr>
					<tr><td>Counter mode invalid</td><td>Enum not recognized</td><td>Use UP/DOWN/CENTERALIGNED1..3</td></tr>
					<tr><td>DMA request not found</td><td>No mapping entry for request</td><td>Correct request or extend mapping</td></tr>
					<tr><td>No matching DMA variant</td><td>User partial specification conflicts with available variants</td><td>Relax or correct fields</td></tr>
					<tr><td>Duplicate MEMORY_TO_MEMORY resource</td><td>Same dma/channel/stream reused</td><td>Select a different variant</td></tr>
					<tr><td>MEMORY_TO_MEMORY requires channel0/stream</td><td>Family-specific constraint violation</td><td>Fix channel/stream</td></tr>
				</tbody>
			</table>
			<h2>Warning Categories</h2>
			<table>
				<thead>
					<tr>
						<th>Message Pattern</th>
						<th>Adjustment</th>
						<th>Rationale</th>
					</tr>
				</thead>
				<tbody>
					<tr><td>Clamped period</td><td>Period set to nearest bound</td><td>Out-of-range numeric</td></tr>
					<tr><td>Clamped prescaler</td><td>Prescaler set to 0 or 65535</td><td>Out-of-range numeric</td></tr>
					<tr><td>Normalized enum casing</td><td>Uppercased value</td><td>User convenience</td></tr>
					<tr><td>Auto-derived irq_handler</td><td>Handler inserted</td><td>Interrupt requested but handler omitted</td></tr>
					<tr><td>Removed stray trigger_source</td><td>Dropped field</td><td>slave_mode disabled</td></tr>
					<tr><td>Selected first DMA variant</td><td>Took index 0</td><td>Deterministic fallback among many</td></tr>
					<tr><td>Removed unsupported field for BASIC timer</td><td>Field dropped</td><td>Hardware capability gating</td></tr>
					<tr><td>Dropped unused DMA</td><td>DMA pruned</td><td>No referencing timers post-refinement</td></tr>
				</tbody>
			</table>
			<h2>Severity Philosophy</h2>
			<p>
				Errors target structural invalidity or potential silent misbehavior. Warnings address recoverable or cosmetic
				issues.
			</p>
			<h2>Color Coding (CLI)</h2>
			<p>
				The refinement script uses ANSI colors: <span class="inline-k" style="color:var(--err)">red</span> for errors,
				<span class="inline-k" style="color:var(--warn)">yellow</span> for warnings.
			</p>
			<h2>Extending Diagnostics</h2>
			<ol>
				<li>Add detection logic in refinement step.</li>
				<li>Centralize message pattern; keep wording consistent.</li>
				<li>Update this page with new pattern &amp; guidance.</li>
			</ol>
			<footer>Diagnostics scaffold.</footer>
		</main>
		<script>
			function filterNav(v) {
				v = v.toLowerCase();
				for (const a of document.querySelectorAll('nav a')) {
					if (a.textContent.toLowerCase().includes(v) || a.getAttribute('href').includes(v)) {
						a.style.display = 'block';
					} else {
						a.style.display = 'none';
					}
				}
			}
		</script>
	</body>
</html>
